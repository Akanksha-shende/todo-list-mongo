<!DOCTYPE html>
<html>
<head>
  <title>Todo List</title>
</head>
<body>
  <h1>Todo List</h1>
  <form action="/todos" method="POST">
    <input type="text" name="title" placeholder="Title" required>
    <input type="text" name="description" placeholder="Description">
    <button type="submit">Add Todo</button>
  </form>

  <ul>
    <% todos.forEach(function(todo) { %>
      <li>
        <strong><%= todo.title %></strong>: <%= todo.description %>
        <button onclick="editTodo('<%= todo._id %>')">Edit</button>
        <button onclick="deleteTodo('<%= todo._id %>')">Delete</button>
      </li>
    <% }); %>
  </ul>

  <script>
    function editTodo(id) {
      const newTitle = prompt('Enter new title:');
      const newDescription = prompt('Enter new description:');
      const completed = confirm('Is the task completed?');

      fetch(`/todos/${id}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ title: newTitle, description: newDescription, completed })
      })
      .then(response => response.json())
      .then(data => {
        alert(data.message);
        location.reload();
      })
      .catch(error => console.error('Error:', error));
    }

    function deleteTodo(id) {
      if (confirm('Are you sure you want to delete this todo?')) {
        fetch(`/todos/${id}`, {
          method: 'DELETE'
        })
        .then(response => response.json())
        .then(data => {
          alert(data.message);
          location.reload();
        })
        .catch(error => console.error('Error:', error));
      }
    }
  </script>
</body>
</html>
